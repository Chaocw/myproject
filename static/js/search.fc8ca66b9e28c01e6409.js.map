{"version":3,"sources":["webpack:///./src/modules/js/api.js","webpack:///./src/modules/js/mixin.js","webpack:///src/components/scroll.vue","webpack:///./src/components/scroll.vue?da7e","webpack:///./src/components/scroll.vue","webpack:///./src/pages/search/search.js"],"names":["url","hotLists","banner","topList","subList","rank","searchList","details","deal","cartAdd","cartLists","cartReduce","cartUpdate","cartRemove","cartMrRemove","addressLists","addressAdd","addressRemove","addressUpdate","addressSetDefault","key","hasOwnProperty","host","__webpack_exports__","filters","number","price","indexOf","slice","components_scroll","fn","this","timeThreshold","lengthThreshold","selectortype_template_index_0_src_components_scroll","render","_vm","_h","$createElement","_self","_c","ref","staticClass","on","scroll","$event","scrollready","staticRenderFns","src_components_scroll","__webpack_require__","normalizeComponent","vue_esm","use","infinite_scroll_default","a","lib_default","parse","location","search","substr","keyword","id","console","log","el","data","isShow","allLoaded","loading","pageNum","pageSize","created","getSearchList","methods","_this","axios_default","post","api","then","res","curLists","lists","length","concat","loadMore","_this2","busy","setTimeout","page","getGoodsList","move","shouldScroll","document","documentElement","scrollTop","toTop","velocity_default","body","duration","scrollHeight","clientHeight","mixins","mixin","components"],"mappings":"yHAsBA,IAAIA,GACAC,UAAU,kBACVC,QAAQ,gBACRC,SAAS,oBACTC,SAAS,oBACTC,MAAM,iBACNC,YAAY,eACZC,SAAS,iBACTC,MAAM,cACNC,SAAS,YACTC,WAAW,aACXC,YAAY,eACZC,YAAY,eACZC,YAAY,eACZC,cAAc,iBACdC,cAAc,gBACdC,YAAY,eACZC,eAAe,kBACfC,eAAe,kBACfC,mBAAmB,uBAOvB,IAAK,IAAIC,KAAOpB,EACZA,EAAIqB,eAAeD,KACrBpB,EAAIoB,GAAKE,2CAAUtB,EAAIoB,GAAK,IAI9BG,EAAA,yCCtCAA,EAAA,GAfCC,SACCC,OADQ,SACDC,GASN,OARAA,GAAS,IAEAC,QAAQ,KAAO,EACvBD,GAAS,KAETA,GAAQ,MAGFA,EAAME,MAAM,EAAGF,EAAMC,QAAQ,KAAO,sPCN9CE,2DAKA,YAEA,8DAKA,iBAEA,YAGAC,WAEAC,kDAEA,WACAC,0CAKA,gLAMAC,mBCnCAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAAL,KAAaM,EAAAD,EAAAE,eAAkD,OAAxBF,EAAAG,MAAAC,IAAAH,GAAwB,OAAiBI,IAAA,YAAAC,YAAA,WAAAC,IAA2CC,OAAA,SAAAC,GAA0BT,EAAAU,YAAAD,QAE9JE,oBCqBjBC,EAvBAC,EAAA,OAcAC,CACArB,EACAK,GATA,EAEA,KAEA,KAEA,MAUA,QCXAiB,EAAA,QAAIC,IAAJC,EAAAC,SAMoBC,EAAAD,EAAGE,MAAMC,SAASC,OAAOC,OAAO,IAA/CC,YAASC,OACdC,QAAQC,IAAIH,EAASC,GAErB,IAAIV,EAAA,SACHa,GAAI,aACJC,MACCJ,KACAvD,WAAY,KACZsD,UACAM,QAAQ,EACRC,WAAW,EACXC,SAAS,EACTC,QAAS,EACTC,SAAU,GAEXC,QAZO,WAaNxC,KAAKyC,iBAGNC,SACCD,cADQ,WACQ,IAAAE,EAAA3C,KAEZA,KAAKqC,UACRrC,KAAKqC,SAAU,EACfO,EAAArB,EAAMsB,KAAKC,EAAA,EAAIvE,YACdsD,UACAC,KACAQ,QAAStC,KAAKsC,QACdC,SAAUvC,KAAKuC,WACbQ,KAAK,SAAAC,GACP,IAAIC,EAAWD,EAAId,KAAKgB,MAErBD,EAASE,OAASR,EAAKJ,WACzBI,EAAKP,WAAY,GAEfO,EAAKpE,WACPoE,EAAKpE,WAAaoE,EAAKpE,WAAW6E,OAAOH,GAGzCN,EAAKpE,WAAa0E,EAGnBN,EAAKN,SAAU,EACfM,EAAKL,cAGPe,SA3BQ,WA2BI,IAAAC,EAAAtD,KACLA,KAAKuD,MAAO,EACZC,WAAW,WACPF,EAAKG,OACLH,EAAKI,gBACN,MAEVC,KAlCQ,WAmCP3D,KAAK4D,eACFC,SAASC,gBAAgBC,UAAY,IACvC/D,KAAKmC,QAAS,EAEdnC,KAAKmC,QAAS,GAGhB6B,MA1CQ,WA2CPC,IAASJ,SAASK,KAAK,UAAUC,SAAU,MAC3CnE,KAAKmC,QAAS,GAEfyB,aA9CQ,WAkDKC,SAASC,gBAAgBM,aAAeP,SAASC,gBAAgBO,aAAeR,SAASC,gBAAgBC,UAAY,IACvH/D,KAAKyC,iBAKV1B,YAxDE,WAyDDf,KAAKyC,kBAGb6B,QAASC,EAAA,GACTC,YACC3D,OAAAI","file":"static/js/search.fc8ca66b9e28c01e6409.js","sourcesContent":["// let url = {\n// \thotLists:['index/hotLists','get'],\n//     banner:['index/banner','get'],\n//     topList:['category/topList','get'],\n//     subList:['category/subList','get'],\n//     rank:['category/rank','get'],\n//     searchList:['search/list','get'],\n//     details:['goods/details','get'],\n//     deal:['goods/deal','get'],\n//     cartAdd:['cart/add','post'],\n//     cartLists:['cart/list','get'],\n//     cartReduce:['cart/reduce','post'],\n//     cartUpdate:['cart/update','post'],\n//     cartRemove:['cart/remove','post'],\n//     cartMrRemove:['cart/mrremove','post'],\n//     addressLists:['address/list','get'],\n//     addressAdd:['address/add','post'],\n//     addressRemove:['address/remove','post'],\n//     addressUpdate:['address/update','post'],\n//     addressSetDefault:['address/setDefault','post']\n// }\n\nlet url = {\n    hotLists:['index/hotLists'],\n    banner:['index/banner'],\n    topList:['category/topList'],\n    subList:['category/subList'],\n    rank:['category/rank'],\n    searchList:['search/list'],\n    details:['goods/details'],\n    deal:['goods/deal'],\n    cartAdd:['cart/add',],\n    cartLists:['cart/list'],\n    cartReduce:['cart/reduce',],\n    cartUpdate:['cart/update',],\n    cartRemove:['cart/remove',],\n    cartMrRemove:['cart/mrremove',],\n    addressLists:['address/list'],\n    addressAdd:['address/add',],\n    addressRemove:['address/remove',],\n    addressUpdate:['address/update',],\n    addressSetDefault:['address/setDefault',]\n}\n\n//开发环境和真实环境的切换 \n//let host = ’‘\nlet host = 'http://rap2api.taobao.org/app/mock/7058'\n\nfor (let key in url) {\n\tif(url.hasOwnProperty(key)) {\n\t\turl[key]=host +'/'+url[key][0]\n\t}\n};\n\nexport default url\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/api.js","let mixin = {\n\tfilters: {\n\t\tnumber(price) {\n\t\t\tprice += ''\n\t\t\t\n\t\t\tif(price.indexOf('.') > 0){\n\t\t\t\tprice += '00'\n\t\t\t}else{\n\t\t\t\tprice +='.00'\n\t\t\t}\n\t\t\t// console.log(price)\n\t\t\treturn price.slice(0, price.indexOf('.') + 3)\n\t\t}\n\t}\n}\n\nexport default mixin\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/mixin.js","<template>\n    <div class = 'car_list' ref='scrollbox' @scroll='scrollready($event)'>\n    </div>\n</template>\n<script>\n    export default {\n        data() {\n            return  {\n                lengthThreshold: 50, //当滑动到距离低端50px时，更新数据\n                timeThreshold: 300,\n                promise: null\n            }\n        },\n        methods: {\n            // 滚动加载列表\n            scrollready() {\n                if(this.shouldScroll()) {\n                    if (this.promise) {\n                        return;\n                    }\n                    // 进行加载\n                    this.fn();\n                    // 防止多次滑动，频繁请求后台资源\n                    let self = this;\n                    this.promise = setTimeout(() => {\n                        self.promise = null;\n                    }, this.timeThreshold);\n                }\n            },\n            // 调用父组件请求资源服务\n            fn() {\n                this.$emit('scrollChange');\n            },\n            shouldScroll() {\n                if(document.scrollTop === 0) {// 滑动距离为0，还没开始滑动\n                    return false;\n                }               // 列表高度 - 列表可视高度 - 滑动的高度 < 50px , 则加载更多\n                return this.$refs.scrollbox.scrollHeight - this.$refs.scrollbox.clientHeight - this.$refs.scrollbox.scrollTop < this.lengthThreshold;\n            },\n        }\n    }\n</script> \n\n\n// WEBPACK FOOTER //\n// src/components/scroll.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"scrollbox\",staticClass:\"car_list\",on:{\"scroll\":function($event){_vm.scrollready($event)}}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7f8c7488\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/scroll.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./scroll.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./scroll.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7f8c7488\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./scroll.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/scroll.vue\n// module id = null\n// module chunks = ","import 'css/common.css'\nimport './search.css'\n\nimport Vue from 'vue'\nimport url from 'js/api.js'\nimport axios from 'axios'\nimport qs from 'qs'\nimport mixin from 'js/mixin.js'\nimport Velocity from 'velocity-animate' \n\nimport { InfiniteScroll } from 'mint-ui';\n\nVue.use(InfiniteScroll);\n\nimport scroll from 'components/scroll.vue'\n\n\n\nlet {keyword, id} = qs.parse(location.search.substr(1))\nconsole.log(keyword, id)\n\nnew Vue({\n\tel: '.container',\n\tdata: {\n\t\tid,\n\t\tsearchList: null,\n\t\tkeyword,\n\t\tisShow: false,\n\t\tallLoaded: false,\n\t\tloading: false,\n\t\tpageNum: 1,\n\t\tpageSize: 6\n\t},\n\tcreated() {\n\t\tthis.getSearchList()\n\n\t},\n\tmethods: {\n\t\tgetSearchList() {\n\t\t\t\n\t\t\tif(this.loading) return \n\t\t\tthis.loading = true\n\t\t\taxios.post(url.searchList,{\n\t\t\t\tkeyword,\n\t\t\t\tid,\n\t\t\t\tpageNum: this.pageNum,\n\t\t\t\tpageSize: this.pageSize\n\t\t\t}).then(res => {\n\t\t\t\tlet curLists = res.data.lists\n\t\t\t\t//判断所有数据是否加载完毕\n\t\t\t\tif(curLists.length < this.pageSize) {\n\t\t\t\t\tthis.allLoaded = true\n\t\t\t\t}\n\t\t\t\tif(this.searchList){\n\t\t\t\t\tthis.searchList = this.searchList.concat(curLists)\n\t\t\t\t}else{\n\t\t\t\t\t//第一次请求数据\n\t\t\t\t\tthis.searchList = curLists\n\t\t\t\t}\n\n\t\t\t\tthis.loading = false\n\t\t\t\tthis.pageNum++\n\t\t\t})\t\t\t\t\t\n\t\t},\n\t\tloadMore () {\n\t        this.busy = true // 无线滚动禁止\n\t        setTimeout(() => {\n\t            this.page++\n\t            this.getGoodsList() // 调用获取商品的接口\n\t        }, 500)\n      \t},\n\t\tmove() {\n\t\t\tthis.shouldScroll()\n\t\t\tif(document.documentElement.scrollTop > 100) {\n\t\t\t\tthis.isShow = true\n\t\t\t}else {\n\t\t\t\tthis.isShow = false\n\t\t\t}\n\t\t},\n\t\ttoTop() {\n\t\t\tVelocity(document.body,'scroll',{duration: 300})\n\t\t\tthis.isShow = false\n\t\t},\n\t\tshouldScroll() {\n            // if(document.scrollTop === 0) {// 滑动距离为0，还没开始滑动\n            //     this.loading = false;\n            // }               // 列表高度 - 列表可视高度 - 滑动的高度 < 50px , 则加载更多\n            if(document.documentElement.scrollHeight - document.documentElement.clientHeight - document.documentElement.scrollTop < 50) {\n            \tthis.getSearchList()\n            }else{\n            \t\n            }\n        },\n        scrollready() {\n        \tthis.getSearchList()\n        }\n\t},\n\tmixins: [mixin],\n\tcomponents: {\n\t\tscroll\n\t}\n})\n\n\n// WEBPACK FOOTER //\n// ./src/pages/search/search.js"],"sourceRoot":""}